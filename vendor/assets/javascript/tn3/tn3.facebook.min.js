/*!
 * tn3 facebook plugin v1.1.0.37
 * http://tn3gallery.com/
 *
 * License
 * http://tn3gallery.com/license
 *
 * Date: 26 Dec, 2011 14:39:48 +0200
 */
(function(f){var h=f.fn.tn3.External;h.facebook=function(c,b){this.config=f.extend(false,{},h.facebook.config,c);this.extcon=b;this.init()};h.facebook.config={source:"albums",ID:"",params:{offset:0,limit:20},aparams:{offset:0,limit:50},albumInfo:{},thumbSize:"thumbnail",imageSize:"normal",imageTitle:"title"};h.facebook.prototype={config:null,extcon:null,init:function(){this.getAlbums()},getAlbums:function(){switch(this.config.source){case "albums":this.request(f.extend({},this.config.aparams),this.config.ID+
"/albums","albums");break;case "batch":break;default:var c={title:this.config.source,adata:{origin:this}};f.extend(c,this.config.albumInfo);this.extcon.setAlbumData([c])}},getImages:function(c,b){var a={},d;a=f.extend(a,this.config.params);a.fields="id,picture,source,height,width,images,link,icon,created_time,updated_time,name";switch(this.config.source){case "albums":d=c.id+"/photos";break;default:d=this.config.ID+"/photos"}this.request(a,d,c,b)},request:function(c,b,a,d){f.ajax({url:"http://graph.facebook.com/"+
b,type:"GET",dataType:"jsonp",cache:false,context:this,jsonp:"callback",success:function(g){typeof a=="string"?this.parseAlbums(a=="albums"?g.data:[g]):this.parsePhotos(g.data,d)},data:c})},parsePhotos:function(c,b){var a=[],d=this,g,e;f.each(c,function(j,i){g={raw:i};e=d.extcon.getAlbumData(b)[d.config.imageTitle];if(e==null)e=d.config.imageTitle;f.extend(g,{title:e,description:i.name,thumb:d.getImagePath("thumb",i),img:d.getImagePath("image",i)});a.push(g)});this.extcon.setImageData(a,b)},parseAlbums:function(c){var b=
[],a=this,d;f.each(c,function(g,e){if(!(e.count===undefined||e.count==0)){d={raw:e};f.extend(d,{title:e.name,description:e.description,from:e.from.name,thumb:a.getImagePath("album",e),adata:{id:e.id,origin:a}});b.push(d)}});this.extcon.setAlbumData(b)},getImagePath:function(c,b){var a;if(c=="album")return b.cover_photo===undefined?"http://graph.facebook.com/"+b.id+"/picture?type=album":"http://graph.facebook.com/"+b.cover_photo+"/picture?type=album";else{a=this.config[c+"Size"];if(typeof a=="number")return b.images[a].source;
else if(a=="original")return b.images[0].source;return"http://graph.facebook.com/"+b.id+"/picture?type="+a}}}})(jQuery);
