/*!
 * tn3 picasa plugin v1.1.0.36
 * http://tn3gallery.com/
 *
 * License
 * http://tn3gallery.com/license
 *
 * Date: 16 Dec, 2011 09:07:43 +0200
 */
(function(d){var g=d.fn.tn3.External;g.picasa=function(a,e){this.config=d.extend(true,{},g.picasa.config,a);this.extcon=e;this.init()};g.picasa.config={userID:"default",source:"albums",albumID:"",params:{"start-index":1,"max-results":20,thumbsize:"72c",imgmax:"1024"},aparams:{thumbsize:"72c"},albumInfo:{}};g.picasa.prototype={config:null,extcon:null,init:function(){this.getAlbums()},getAlbums:function(){if(this.config.source=="albums"){var a={};a=d.extend(a,this.config.aparams);a.kind="album";this.request(a,
"user/"+this.config.userID)}else{a={title:this.config.source,adata:{origin:this}};d.extend(a,this.config.albumInfo);this.extcon.setAlbumData([a])}},getImages:function(a,e){var f={},b;f=d.extend(f,this.config.params);f.kind="photo";switch(this.config.source){case "albums":b="user/"+this.config.userID+"/albumid/"+a.id;break;case "photos":b="user/"+this.config.userID;break;case "album":b="user/"+this.config.userID+"/albumid/"+this.config.albumID;break;case "featured":b="featured";break;case "all":b=
"all";break;default:return}this.request(f,b,a,e)},request:function(a,e,f,b){a.alt="json-in-script";d.ajax({url:"http://picasaweb.google.com/data/feed/api/"+e,type:"GET",dataType:"jsonp",cache:false,context:this,jsonp:"callback",success:function(h){a.kind=="album"?this.parseAlbums(h.feed.entry):this.parsePhotos(h.feed.entry,b)},data:a})},parsePhotos:function(a,e){var f=[],b;d.each(a,function(h,c){b={raw:c};d.extend(b,{title:c.media$group.media$title.$t,description:c.media$group.media$description.$t,
thumb:c.media$group.media$thumbnail[0].url,img:c.media$group.media$content[0].url});f.push(b)});this.extcon.setImageData(f,e)},parseAlbums:function(a){var e=[],f=this,b;d.each(a,function(h,c){if(c.gphoto$numphotos.$t!=0){b={raw:c};d.extend(b,{title:c.title.$t,description:c.summary.$t,thumb:c.media$group.media$thumbnail[0].url,adata:{id:c.gphoto$id.$t,origin:f}});e.push(b)}});this.extcon.setAlbumData(e)}}})(jQuery);
