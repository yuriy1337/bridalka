/*!
 * tn3 picasa plugin v1.3.0.52
 * http://tn3gallery.com/
 *
 * License
 * http://tn3gallery.com/license
 *
 * Date: 07 Sep, 2012 12:33:07 +0300
 */
(function(e){var i=e.fn.tn3.External;i.picasa=function(a,d){this.config=e.extend(true,{},i.picasa.config,a);this.extcon=d;this.init()};i.picasa.config={userID:"default",source:"albums",albumID:"",params:{"start-index":1,"max-results":20,thumbsize:"72c",imgmax:"1024"},aparams:{thumbsize:"72c"},albumInfo:{}};i.picasa.prototype={config:null,extcon:null,init:function(){this.getAlbums()},getAlbums:function(){if(this.config.source=="albums"){var a={};a=e.extend(a,this.config.aparams);a.kind="album";this.request(a,
"user/"+this.config.userID)}else{a={title:this.config.source,adata:{origin:this}};e.extend(a,this.config.albumInfo);this.extcon.setAlbumData([a])}},getImages:function(a,d){var b={},c;b=e.extend(b,this.config.params);b.kind="photo";switch(this.config.source){case "albums":c="user/"+this.config.userID+"/albumid/"+a.id;break;case "photos":c="user/"+this.config.userID;break;case "album":c="user/"+this.config.userID+"/albumid/"+this.config.albumID;break;case "featured":c="featured";break;case "all":c=
"all";break;default:return}this.request(b,c,a,d)},request:function(a,d,b,c){a.alt="json-in-script";e.ajax({url:"http://picasaweb.google.com/data/feed/api/"+d,type:"GET",dataType:"jsonp",cache:false,context:this,jsonp:"callback",success:function(f){a.kind=="album"?this.parseAlbums(f.feed.entry):this.parsePhotos(f.feed.entry,c)},data:a})},parsePhotos:function(a,d){var b=[],c=this,f;e.each(a,function(h,g){f={raw:g};e.extend(f,{title:g.media$group.media$title.$t,description:g.media$group.media$description.$t,
thumb:g.media$group.media$thumbnail[0].url,img:g.media$group.media$content[0].url});if(g.gphoto$videostatus&&g.gphoto$videostatus.$t=="final")f.content=c.getVideoContent(g,f.img);b.push(f)});this.extcon.setImageData(b,d)},getVideoContent:function(a,d){var b=a.media$group.media$content[2];return'<video width="'+b.width+'" height="'+b.height+'" poster="'+d+'" type="video/mp4" src="'+b.url+'" controls="controls" preload="none"></video>'},parseAlbums:function(a){var d=[],b=this,c;e.each(a,function(f,
h){if(h.gphoto$numphotos.$t!=0){c={raw:h};e.extend(c,{title:h.title.$t,description:h.summary.$t,thumb:h.media$group.media$thumbnail[0].url,adata:{id:h.gphoto$id.$t,origin:b}});d.push(c)}});this.extcon.setAlbumData(d)}}})(jQuery);
